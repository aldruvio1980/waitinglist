<!DOCTYPE html>
<html>
<head>
    <title>Host Dashboard</title>
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
</head>
<body class="bg-slate-900 text-white p-6">
    <div class="max-w-md mx-auto">
        <h1 class="text-2xl font-bold mb-2 text-blue-400">Host Dashboard</h1>
        
        <div id="status-dot" class="text-sm mb-4 flex items-center gap-2">
            <span class="w-3 h-3 bg-yellow-500 rounded-full animate-pulse"></span>
            Connecting to network...
        </div>

        <div class="bg-white p-4 inline-block rounded mb-6">
            <div id="qrcode"></div>
        </div>
        
        <div class="bg-slate-800 rounded-lg p-4">
            <h2 class="font-bold border-b border-slate-700 pb-2 mb-4 text-gray-400">Live Waiting List</h2>
            <ul id="guestList" class="space-y-3">
                </ul>
        </div>
    </div>

    <script>
        // 1. SET YOUR GITHUB URL HERE
        // Replace 'yourusername' with your actual GitHub username
        const myGitHubURL = "https://yourusername.github.io/waitinglist/guest.html";

        // 2. Setup Peer connection
        const hostID = 'shop-' + Math.floor(Math.random() * 9999);
        const peer = new Peer(hostID);
        
        peer.on('open', (id) => {
            document.getElementById('status-dot').innerHTML = `
                <span class="w-3 h-3 bg-green-500 rounded-full"></span>
                System Ready (ID: ${id})
            `;
            
            // Generate QR linking to your GUEST page
            const finalGuestUrl = `${myGitHubURL}?host=${id}`;
            new QRCode(document.getElementById("qrcode"), {
                text: finalGuestUrl,
                width: 150,
                height: 150
            });
        });

        // 3. Listen for guests joining
        peer.on('connection', (conn) => {
            conn.on('data', (data) => {
                const li = document.createElement('li');
                li.className = "flex justify-between items-center bg-slate-700 p-3 rounded border-l-4 border-blue-500";
                li.innerHTML = `
                    <div>
                        <div class="font-bold text-white">${data.name}</div>
                        <div class="text-xs text-gray-400">${data.phone}</div>
                    </div>
                    <a href="sms:${data.phone}?body=Hello ${data.name}, your table is ready!" 
                       class="bg-green-600 hover:bg-green-500 px-4 py-2 rounded text-sm font-bold transition">
                       Notify
                    </a>
                `;
                document.getElementById('guestList').appendChild(li);
            });
        });

        peer.on('error', (err) => {
            console.error(err);
            alert("Connection error. Please refresh.");
        });
    </script>
</body>
</html>